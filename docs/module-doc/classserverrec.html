<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>InspIRCd: serverrec class Reference</title>
<link href="inspircd.doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.3 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Compound&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Compound&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>serverrec Class Reference</h1>A class that defines the local server or a remote server.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="servers_8h-source.html">servers.h</a>&gt;</code>
<p>
Inheritance diagram for serverrec:<p><center><img src="classserverrec__inherit__graph.gif" border="0" usemap="#serverrec__inherit__map" alt="Inheritance graph"></center>
<map name="serverrec__inherit__map">
<area href="classconnection.html" shape="rect" coords="7,157,93,184" alt="">
<area href="classExtensible.html" shape="rect" coords="9,82,91,109" alt="">
<area href="classclassbase.html" shape="rect" coords="10,8,90,34" alt="">
</map>
<center><font size="2">[<a target="top" href="graph_legend.html">legend</a>]</font></center>Collaboration diagram for serverrec:<p><center><img src="classserverrec__coll__graph.gif" border="0" usemap="#serverrec__coll__map" alt="Collaboration graph"></center>
<map name="serverrec__coll__map">
<area href="classconnection.html" shape="rect" coords="210,249,296,275" alt="">
</map>
<center><font size="2">[<a target="top" href="graph_legend.html">legend</a>]</font></center><a href="classserverrec-members.html">List of all members.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classserverrec.html#a0">serverrec</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constructor. </em> <a href="#a0"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classserverrec.html#a1">serverrec</a> (char *n, long ver, bool jupe)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constructor which initialises some of the main variables. </em> <a href="#a1"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classserverrec.html#a2">~serverrec</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destructor. </em> <a href="#a2"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>bool&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classserverrec.html#a3">CreateListener</a> (char *<a class="el" href="classconnection.html#o1">host</a>, int p)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a listening socket on 'host' using port number 'p'. </em> <a href="#a3"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>bool&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classserverrec.html#a4">BeginLink</a> (char *targethost, int <a class="el" href="classconnection.html#o8">port</a>, char *password, char *servername, int myport)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Begin an outbound link to another ircd at targethost. </em> <a href="#a4"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>bool&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classserverrec.html#a5">MeshCookie</a> (char *targethost, int <a class="el" href="classconnection.html#o8">port</a>, unsigned long cookie, char *servername)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Begin an outbound mesh link to another ircd on a network you are already an authenticated member of. </em> <a href="#a5"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classserverrec.html#a6">TerminateLink</a> (char *targethost)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Terminate a link to 'targethost' by calling the <a class="el" href="classircd__connector.html#a14">ircd_connector::CloseConnection</a> method. </em> <a href="#a6"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>bool&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classserverrec.html#a7">SendPacket</a> (char *message, const char *<a class="el" href="classconnection.html#o1">host</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send a message to a server by name, if the server is unavailable directly route the packet via another server If the server still cannot be reached after attempting to route the message remotely, returns false. </em> <a href="#a7"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>bool&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classserverrec.html#a8">RecvPacket</a> (std::deque&lt; std::string &gt; &amp;messages, char *<a class="el" href="classconnection.html#o1">host</a>, std::deque&lt; std::string &gt; &amp;sums)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the next available packet and returns true if data is available. </em> <a href="#a8"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="classircd__connector.html">ircd_connector</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classserverrec.html#a9">FindHost</a> (std::string <a class="el" href="classconnection.html#o1">host</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Find the <a class="el" href="classircd__connector.html">ircd_connector</a> oject related to a certain servername given in 'host'. </em> <a href="#a9"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>bool&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classserverrec.html#a10">AddIncoming</a> (int <a class="el" href="classconnection.html#o0">fd</a>, char *targethost, int sourceport)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add an incoming connection to the connection pool. </em> <a href="#a10"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classserverrec.html#a11">FlushWriteBuffers</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Flushes all data waiting to be written for all of this server's connections. </em> <a href="#a11"></a><em><br><br></td></tr>
<tr><td colspan=2><br><h2>Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>char&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classserverrec.html#o0">name</a> [MAXBUF]</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">server name </em> <a href="#o0"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>long&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classserverrec.html#o1">pingtime</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">last ping response (ms) </em> <a href="#o1"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>long&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classserverrec.html#o2">usercount_i</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">invisible users on server </em> <a href="#o2"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>long&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classserverrec.html#o3">usercount</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">non-invisible users on server </em> <a href="#o3"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>long&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classserverrec.html#o4">opercount</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">opers on server </em> <a href="#o4"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classserverrec.html#o5">hops_away</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">number of hops away (for quick access) </em> <a href="#o5"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>long&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classserverrec.html#o6">version</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">ircd version </em> <a href="#o6"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>bool&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classserverrec.html#o7">jupiter</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">is a JUPE server (faked to enforce a server ban) </em> <a href="#o7"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>char&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classserverrec.html#o8">description</a> [MAXBUF]</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Description of the server. </em> <a href="#o8"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>char&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classserverrec.html#o9">nickserv</a> [NICKMAX]</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Holds nickserv's name on U:lined (services) servers (this is a kludge for ircservices which ASSUMES things :/). </em> <a href="#o9"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>bool&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classserverrec.html#o10">sync_soon</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>std::vector&lt; <a class="el" href="classircd__connector.html">ircd_connector</a> &gt;&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classserverrec.html#o11">connectors</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">With a serverrec, this is a list of all established server connections. </em> <a href="#o11"></a><em><br><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
A class that defines the local server or a remote server. 
<p>

<p>
Definition at line <a class="el" href="servers_8h-source.html#l00030">30</a> of file <a class="el" href="servers_8h-source.html">servers.h</a>.<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a name="a0" doxytag="serverrec::serverrec"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> serverrec::serverrec </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Constructor. 
<p>

<p>
Definition at line <a class="el" href="servers_8cpp-source.html#l00046">46</a> of file <a class="el" href="servers_8cpp-source.html">servers.cpp</a>.
<p>
References <a class="el" href="servers_8h-source.html#l00081">connectors</a>, <a class="el" href="connection_8h-source.html#l00266">connection::fd</a>, <a class="el" href="servers_8h-source.html#l00051">hops_away</a>, <a class="el" href="servers_8h-source.html#l00057">jupiter</a>, <a class="el" href="connection_8h-source.html#l00308">connection::lastping</a>, <a class="el" href="servers_8h-source.html#l00036">name</a>, <a class="el" href="servers_8h-source.html#l00065">nickserv</a>, <a class="el" href="servers_8h-source.html#l00048">opercount</a>, <a class="el" href="servers_8h-source.html#l00039">pingtime</a>, <a class="el" href="connection_8h-source.html#l00312">connection::signon</a>, <a class="el" href="servers_8h-source.html#l00067">sync_soon</a>, <a class="el" href="channels_8cpp-source.html#l00101">TIME</a>, <a class="el" href="servers_8h-source.html#l00045">usercount</a>, <a class="el" href="servers_8h-source.html#l00042">usercount_i</a>, and <a class="el" href="servers_8h-source.html#l00054">version</a>.
<p>
<div class="fragment"><pre>00047 {
00048         strlcpy(name,<span class="stringliteral">""</span>,256);
00049         <a class="code" href="classserverrec.html#o1">pingtime</a> = 0;
00050         <a class="code" href="classconnection.html#o10">lastping</a> = <a class="code" href="channels_8cpp.html#a36">TIME</a>;
00051         <a class="code" href="classserverrec.html#o2">usercount_i</a> = <a class="code" href="classserverrec.html#o3">usercount</a> = <a class="code" href="classserverrec.html#o4">opercount</a> = <a class="code" href="classserverrec.html#o6">version</a> = 0;
00052         <a class="code" href="classserverrec.html#o5">hops_away</a> = 1;
00053         <a class="code" href="classconnection.html#o11">signon</a> = <a class="code" href="channels_8cpp.html#a36">TIME</a>;
00054         <a class="code" href="classserverrec.html#o7">jupiter</a> = <span class="keyword">false</span>;
00055         <a class="code" href="classconnection.html#o0">fd</a> = 0;
00056         <a class="code" href="classserverrec.html#o10">sync_soon</a> = <span class="keyword">false</span>;
00057         strlcpy(nickserv,<span class="stringliteral">""</span>,NICKMAX);
00058         <a class="code" href="classserverrec.html#o11">connectors</a>.clear();
00059 }
</pre></div>    </td>
  </tr>
</table>
<a name="a1" doxytag="serverrec::serverrec"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> serverrec::serverrec </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname" nowrap> <em>n</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>long&nbsp;</td>
          <td class="mdname" nowrap> <em>ver</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>bool&nbsp;</td>
          <td class="mdname" nowrap> <em>jupe</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Constructor which initialises some of the main variables. 
<p>

<p>
Definition at line <a class="el" href="servers_8cpp-source.html#l00066">66</a> of file <a class="el" href="servers_8cpp-source.html">servers.cpp</a>.
<p>
References <a class="el" href="servers_8h-source.html#l00081">connectors</a>, <a class="el" href="connection_8h-source.html#l00266">connection::fd</a>, <a class="el" href="servers_8h-source.html#l00051">hops_away</a>, <a class="el" href="servers_8h-source.html#l00057">jupiter</a>, <a class="el" href="connection_8h-source.html#l00308">connection::lastping</a>, <a class="el" href="servers_8h-source.html#l00036">name</a>, <a class="el" href="servers_8h-source.html#l00065">nickserv</a>, <a class="el" href="servers_8h-source.html#l00048">opercount</a>, <a class="el" href="connection_8h-source.html#l00312">connection::signon</a>, <a class="el" href="servers_8h-source.html#l00067">sync_soon</a>, <a class="el" href="channels_8cpp-source.html#l00101">TIME</a>, <a class="el" href="servers_8h-source.html#l00045">usercount</a>, <a class="el" href="servers_8h-source.html#l00042">usercount_i</a>, and <a class="el" href="servers_8h-source.html#l00054">version</a>.
<p>
<div class="fragment"><pre>00067 {
00068         strlcpy(name,n,256);
00069         <a class="code" href="classconnection.html#o10">lastping</a> = <a class="code" href="channels_8cpp.html#a36">TIME</a>;
00070         <a class="code" href="classserverrec.html#o2">usercount_i</a> = <a class="code" href="classserverrec.html#o3">usercount</a> = <a class="code" href="classserverrec.html#o4">opercount</a> = 0;
00071         <a class="code" href="classserverrec.html#o6">version</a> = ver;
00072         <a class="code" href="classserverrec.html#o5">hops_away</a> = 1;
00073         <a class="code" href="classconnection.html#o11">signon</a> = <a class="code" href="channels_8cpp.html#a36">TIME</a>;
00074         <a class="code" href="classserverrec.html#o7">jupiter</a> = jupe;
00075         <a class="code" href="classconnection.html#o0">fd</a> = 0;
00076         <a class="code" href="classserverrec.html#o10">sync_soon</a> = <span class="keyword">false</span>;
00077         strlcpy(nickserv,<span class="stringliteral">""</span>,NICKMAX);
00078         <a class="code" href="classserverrec.html#o11">connectors</a>.clear();
00079 }
</pre></div>    </td>
  </tr>
</table>
<a name="a2" doxytag="serverrec::~serverrec"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> serverrec::~<a class="el" href="classserverrec.html">serverrec</a> </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Destructor. 
<p>

<p>
Definition at line <a class="el" href="servers_8cpp-source.html#l00062">62</a> of file <a class="el" href="servers_8cpp-source.html">servers.cpp</a>.
<p>
<div class="fragment"><pre>00063 {
00064 }
</pre></div>    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a name="a10" doxytag="serverrec::AddIncoming"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> bool serverrec::AddIncoming </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>fd</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>targethost</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>sourceport</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Add an incoming connection to the connection pool. 
<p>
(reserved for core use) 
<p>
Definition at line <a class="el" href="servers_8cpp-source.html#l00212">212</a> of file <a class="el" href="servers_8cpp-source.html">servers.cpp</a>.
<p>
References <a class="el" href="servers_8h-source.html#l00081">connectors</a>, <a class="el" href="modules_8h-source.html#l00023">DEBUG</a>, <a class="el" href="classircd__connector.html#a5">ircd_connector::SetDescriptor()</a>, <a class="el" href="classircd__connector.html#a13">ircd_connector::SetHostAndPort()</a>, <a class="el" href="classircd__connector.html#a3">ircd_connector::SetServerName()</a>, <a class="el" href="classircd__connector.html#a7">ircd_connector::SetState()</a>, and <a class="el" href="connection_8h-source.html#l00038">STATE_NOAUTH_INBOUND</a>.
<p>
<div class="fragment"><pre>00213 {
00214         <a class="code" href="classircd__connector.html">ircd_connector</a> connector;
00215 
00216         <span class="comment">// targethost has been turned into an ip...</span>
00217         <span class="comment">// we dont want this as the server name.</span>
00218         connector.<a class="code" href="classircd__connector.html#a3">SetServerName</a>(targethost);
00219         connector.<a class="code" href="classircd__connector.html#a5">SetDescriptor</a>(newfd);
00220         connector.<a class="code" href="classircd__connector.html#a7">SetState</a>(STATE_NOAUTH_INBOUND);
00221         <span class="keywordtype">int</span> flags = fcntl(newfd, F_GETFL, 0);
00222         fcntl(newfd, F_SETFL, flags | O_NONBLOCK);
00223         <span class="keywordtype">int</span> sendbuf = 32768;
00224         <span class="keywordtype">int</span> recvbuf = 32768;
00225         setsockopt(newfd,SOL_SOCKET,SO_SNDBUF,(<span class="keyword">const</span> <span class="keywordtype">void</span> *)&amp;sendbuf,<span class="keyword">sizeof</span>(sendbuf));
00226         setsockopt(newfd,SOL_SOCKET,SO_RCVBUF,(<span class="keyword">const</span> <span class="keywordtype">void</span> *)&amp;recvbuf,<span class="keyword">sizeof</span>(sendbuf));
00227         connector.<a class="code" href="classircd__connector.html#a13">SetHostAndPort</a>(targethost, sourceport);
00228         connector.<a class="code" href="classircd__connector.html#a7">SetState</a>(STATE_NOAUTH_INBOUND);
00229         log(DEBUG,<span class="stringliteral">"serverrec::AddIncoming() Added connection: %s:%d"</span>,targethost,sourceport);
00230         this-&gt;<a class="code" href="classserverrec.html#o11">connectors</a>.push_back(connector);
00231         <span class="keywordflow">return</span> <span class="keyword">true</span>;
00232 }
</pre></div>    </td>
  </tr>
</table>
<a name="a4" doxytag="serverrec::BeginLink"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> bool serverrec::BeginLink </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname" nowrap> <em>targethost</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>password</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>servername</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>myport</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Begin an outbound link to another ircd at targethost. 
<p>

<p>
Definition at line <a class="el" href="servers_8cpp-source.html#l00142">142</a> of file <a class="el" href="servers_8cpp-source.html">servers.cpp</a>.
<p>
References <a class="el" href="servers_8h-source.html#l00081">connectors</a>, <a class="el" href="connection_8h-source.html#l00266">connection::fd</a>, <a class="el" href="servers_8cpp-source.html#l00242">FindHost()</a>, <a class="el" href="classircd__connector.html#a1">ircd_connector::MakeOutboundConnection()</a>, <a class="el" href="servers_8cpp-source.html#l00336">SendPacket()</a>, <a class="el" href="classircd__connector.html#a13">ircd_connector::SetHostAndPort()</a>, <a class="el" href="classircd__connector.html#a3">ircd_connector::SetServerName()</a>, <a class="el" href="classircd__connector.html#a7">ircd_connector::SetState()</a>, <a class="el" href="connection_8h-source.html#l00035">STATE_DISCONNECTED</a>, and <a class="el" href="connection_8h-source.html#l00039">STATE_NOAUTH_OUTBOUND</a>.
<p>
<div class="fragment"><pre>00143 {
00144         <span class="keywordtype">char</span> connect[MAXBUF];
00145 
00146         <a class="code" href="classircd__connector.html">ircd_connector</a> connector;
00147         <a class="code" href="classircd__connector.html">ircd_connector</a> *cn = this-&gt;<a class="code" href="classserverrec.html#a9">FindHost</a>(servername);
00148 
00149 
00150         <span class="keywordflow">if</span> (cn)
00151         {
00152                 WriteOpers(<span class="stringliteral">"CONNECT aborted: Server %s already exists"</span>,servername);
00153                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
00154         }
00155 
00156 
00157         <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classconnection.html#o0">fd</a>)
00158         {
00159                 <span class="keywordflow">if</span> (connector.<a class="code" href="classircd__connector.html#a1">MakeOutboundConnection</a>(targethost,newport))
00160                 {
00161                         <span class="comment">// targethost has been turned into an ip...</span>
00162                         <span class="comment">// we dont want this as the server name.</span>
00163                         connector.<a class="code" href="classircd__connector.html#a3">SetServerName</a>(servername);
00164                         snprintf(connect,MAXBUF,<span class="stringliteral">"S %s %s %lu %s :%s"</span>,getservername().c_str(),password,(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)myport,GetRevision().c_str(),getserverdesc().c_str());
00165                         connector.<a class="code" href="classircd__connector.html#a7">SetState</a>(STATE_NOAUTH_OUTBOUND);
00166                         connector.<a class="code" href="classircd__connector.html#a13">SetHostAndPort</a>(targethost, newport);
00167                         this-&gt;<a class="code" href="classserverrec.html#o11">connectors</a>.push_back(connector);
00168                         <span class="comment">// this packet isn't actually sent until the socket connects -- the STATE_NOAUTH_OUTBOUND state</span>
00169                         <span class="comment">// queues outbound data until the socket is polled as writeable (e.g. the connection is established)</span>
00170                         <span class="keywordflow">return</span> this-&gt;<a class="code" href="classserverrec.html#a7">SendPacket</a>(connect, servername);
00171                 }
00172                 <span class="keywordflow">else</span>
00173                 {
00174                         connector.<a class="code" href="classircd__connector.html#a7">SetState</a>(STATE_DISCONNECTED);
00175                         WriteOpers(<span class="stringliteral">"Could not create outbound connection to %s:%d"</span>,targethost,newport);
00176                 }
00177         }
00178         <span class="keywordflow">return</span> <span class="keyword">false</span>;
00179 }
</pre></div>    </td>
  </tr>
</table>
<a name="a3" doxytag="serverrec::CreateListener"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> bool serverrec::CreateListener </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname" nowrap> <em>host</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>p</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Create a listening socket on 'host' using port number 'p'. 
<p>

<p>
Definition at line <a class="el" href="servers_8cpp-source.html#l00081">81</a> of file <a class="el" href="servers_8cpp-source.html">servers.cpp</a>.
<p>
References <a class="el" href="connection_8h-source.html#l00266">connection::fd</a>, <a class="el" href="servers_8cpp-source.html#l00038">MaxConn</a>, and <a class="el" href="connection_8h-source.html#l00300">connection::port</a>.
<p>
<div class="fragment"><pre>00082 {
00083         sockaddr_in host_address;
00084         <span class="keywordtype">int</span> flags;
00085         in_addr addy;
00086         <span class="keywordtype">int</span> on = 0;
00087         <span class="keyword">struct </span>linger linger = { 0 };
00088 
00089         this-&gt;<a class="code" href="classconnection.html#o8">port</a> = p;
00090 
00091         <a class="code" href="classconnection.html#o0">fd</a> = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);
00092         <span class="keywordflow">if</span> (<a class="code" href="classconnection.html#o0">fd</a> &lt;= 0)
00093         {
00094                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
00095         }
00096 
00097         setsockopt(fd,SOL_SOCKET,SO_REUSEADDR,(<span class="keyword">const</span> <span class="keywordtype">char</span>*)&amp;on,<span class="keyword">sizeof</span>(on));
00098         linger.l_onoff = 1;
00099         linger.l_linger = 1;
00100         setsockopt(fd,SOL_SOCKET,SO_LINGER,(<span class="keyword">const</span> <span class="keywordtype">char</span>*)&amp;linger,<span class="keyword">sizeof</span>(linger));
00101 
00102         <span class="comment">// attempt to increase socket sendq and recvq as high as its possible</span>
00103         <span class="comment">// to get them on linux.</span>
00104         <span class="keywordtype">int</span> sendbuf = 32768;
00105         <span class="keywordtype">int</span> recvbuf = 32768;
00106         setsockopt(fd,SOL_SOCKET,SO_SNDBUF,(<span class="keyword">const</span> <span class="keywordtype">void</span> *)&amp;sendbuf,<span class="keyword">sizeof</span>(sendbuf));
00107         setsockopt(fd,SOL_SOCKET,SO_RCVBUF,(<span class="keyword">const</span> <span class="keywordtype">void</span> *)&amp;recvbuf,<span class="keyword">sizeof</span>(sendbuf));
00108 
00109         memset((<span class="keywordtype">void</span>*)&amp;host_address, 0, <span class="keyword">sizeof</span>(host_address));
00110 
00111         host_address.sin_family = AF_INET;
00112 
00113         <span class="keywordflow">if</span> (!strcmp(newhost,<span class="stringliteral">""</span>))
00114         {
00115                 host_address.sin_addr.s_addr = htonl(INADDR_ANY);
00116         }
00117         <span class="keywordflow">else</span>
00118         {
00119                 inet_aton(newhost,&amp;addy);
00120                 host_address.sin_addr = addy;
00121         }
00122 
00123         host_address.sin_port = htons(p);
00124 
00125         <span class="keywordflow">if</span> (bind(fd,(sockaddr*)&amp;host_address,<span class="keyword">sizeof</span>(host_address))&lt;0)
00126         {
00127                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
00128         }
00129 
00130         <span class="comment">// make the socket non-blocking</span>
00131         flags = fcntl(fd, F_GETFL, 0);
00132         fcntl(fd, F_SETFL, flags | O_NONBLOCK);
00133 
00134         this-&gt;<a class="code" href="classconnection.html#o8">port</a> = p;
00135 
00136         listen(this-&gt;fd, MaxConn);
00137 
00138         <span class="keywordflow">return</span> <span class="keyword">true</span>;
00139 }
</pre></div>    </td>
  </tr>
</table>
<a name="a9" doxytag="serverrec::FindHost"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="classircd__connector.html">ircd_connector</a> * serverrec::FindHost </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">std::string&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>host</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Find the <a class="el" href="classircd__connector.html">ircd_connector</a> oject related to a certain servername given in 'host'. 
<p>

<p>
Definition at line <a class="el" href="servers_8cpp-source.html#l00242">242</a> of file <a class="el" href="servers_8cpp-source.html">servers.cpp</a>.
<p>
References <a class="el" href="servers_8h-source.html#l00081">connectors</a>.
<p>
Referenced by <a class="el" href="servers_8cpp-source.html#l00142">BeginLink()</a>, <a class="el" href="servers_8cpp-source.html#l00256">IsRoutable()</a>, and <a class="el" href="servers_8cpp-source.html#l00336">SendPacket()</a>.
<p>
<div class="fragment"><pre>00243 {
00244         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; this-&gt;<a class="code" href="classserverrec.html#o11">connectors</a>.size(); i++)
00245         {
00246                 <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classserverrec.html#o11">connectors</a>[i].GetServerName() == findhost)
00247                 {
00248                         <span class="keywordflow">return</span> &amp;this-&gt;<a class="code" href="classserverrec.html#o11">connectors</a>[i];
00249                 }
00250         }
00251         <span class="keywordflow">return</span> NULL;
00252 }
</pre></div>    </td>
  </tr>
</table>
<a name="a11" doxytag="serverrec::FlushWriteBuffers"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void serverrec::FlushWriteBuffers </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Flushes all data waiting to be written for all of this server's connections. 
<p>

<p>
Definition at line <a class="el" href="servers_8cpp-source.html#l00284">284</a> of file <a class="el" href="servers_8cpp-source.html">servers.cpp</a>.
<p>
References <a class="el" href="servers_8h-source.html#l00081">connectors</a>, <a class="el" href="servers_8cpp-source.html#l00042">has_been_netsplit</a>, <a class="el" href="servers_8cpp-source.html#l00256">IsRoutable()</a>, <a class="el" href="connection_8h-source.html#l00035">STATE_DISCONNECTED</a>, <a class="el" href="connection_8h-source.html#l00038">STATE_NOAUTH_INBOUND</a>, <a class="el" href="connection_8h-source.html#l00039">STATE_NOAUTH_OUTBOUND</a>, and <a class="el" href="channels_8cpp-source.html#l00101">TIME</a>.
<p>
<div class="fragment"><pre>00285 {
00286         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; this-&gt;<a class="code" href="classserverrec.html#o11">connectors</a>.size(); i++)
00287         {
00288                 <span class="comment">// don't try and ping a NOAUTH_OUTBOUND state, its not authed yet!</span>
00289                 <span class="keywordflow">if</span> ((this-&gt;<a class="code" href="classserverrec.html#o11">connectors</a>[i].GetState() == <a class="code" href="connection_8h.html#a4">STATE_NOAUTH_OUTBOUND</a>) &amp;&amp; (<a class="code" href="channels_8cpp.html#a36">TIME</a> &gt; this-&gt;<a class="code" href="classserverrec.html#o11">connectors</a>[i].age+30))
00290                 {
00291                         <span class="comment">// however if we reach this timer its connected timed out :)</span>
00292                         WriteOpers(<span class="stringliteral">"*** Connection to %s timed out"</span>,this-&gt;connectors[i].GetServerName().c_str());
00293                         DoSplit(this-&gt;connectors[i].GetServerName().c_str());
00294                         <span class="keywordflow">return</span>;
00295                 }
00296                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((this-&gt;connectors[i].GetState() == <a class="code" href="connection_8h.html#a3">STATE_NOAUTH_INBOUND</a>) &amp;&amp; (<a class="code" href="channels_8cpp.html#a36">TIME</a> &gt; this-&gt;connectors[i].age+30))
00297                 {
00298                         WriteOpers(<span class="stringliteral">"*** Connection from %s timed out"</span>,this-&gt;connectors[i].GetServerName().c_str());
00299                         DoSplit(this-&gt;connectors[i].GetServerName().c_str());
00300                         <span class="keywordflow">return</span>;
00301                 }
00302                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (this-&gt;connectors[i].GetState() != <a class="code" href="connection_8h.html#a0">STATE_DISCONNECTED</a>)
00303                 {
00304                         <span class="keywordflow">if</span> (!this-&gt;connectors[i].CheckPing())
00305                         {
00306                                 WriteOpers(<span class="stringliteral">"*** Lost single connection to %s: Ping timeout"</span>,this-&gt;connectors[i].GetServerName().c_str());
00307                                 this-&gt;connectors[i].CloseConnection();
00308                                 this-&gt;connectors[i].SetState(STATE_DISCONNECTED);
00309                                 <span class="keywordflow">if</span> (!<a class="code" href="servers_8cpp.html#a5">IsRoutable</a>(this-&gt;connectors[i].GetServerName()))
00310                                 {
00311                                         WriteOpers(<span class="stringliteral">"*** Server %s is no longer routable, disconnecting."</span>,this-&gt;connectors[i].GetServerName().c_str());
00312                                         DoSplit(this-&gt;connectors[i].GetServerName().c_str());
00313                                 }
00314                                 <a class="code" href="servers_8cpp.html#a3">has_been_netsplit</a> = <span class="keyword">true</span>;
00315                         }
00316                 }
00317                 <span class="keywordflow">if</span> (this-&gt;connectors[i].HasBufferedOutput())
00318                 {
00319                         <span class="keywordflow">if</span> (!this-&gt;connectors[i].FlushWriteBuf())
00320                         {
00321                                 <span class="comment">// if we're here the write() caused an error, we cannot proceed</span>
00322                                 WriteOpers(<span class="stringliteral">"*** Lost single connection to %s, link inactive and retrying: %s"</span>,this-&gt;connectors[i].GetServerName().c_str(),this-&gt;connectors[i].GetWriteError().c_str());
00323                                 this-&gt;connectors[i].CloseConnection();
00324                                 this-&gt;connectors[i].SetState(STATE_DISCONNECTED);
00325                                 <span class="keywordflow">if</span> (!<a class="code" href="servers_8cpp.html#a5">IsRoutable</a>(this-&gt;connectors[i].GetServerName()))
00326                                 {
00327                                         WriteOpers(<span class="stringliteral">"*** Server %s is no longer routable, disconnecting."</span>,this-&gt;connectors[i].GetServerName().c_str());
00328                                         DoSplit(this-&gt;connectors[i].GetServerName().c_str());
00329                                 }
00330                                 <a class="code" href="servers_8cpp.html#a3">has_been_netsplit</a> = <span class="keyword">true</span>;
00331                         }
00332                 }
00333         }
00334 }
</pre></div>    </td>
  </tr>
</table>
<a name="a5" doxytag="serverrec::MeshCookie"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> bool serverrec::MeshCookie </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname" nowrap> <em>targethost</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>unsigned long&nbsp;</td>
          <td class="mdname" nowrap> <em>cookie</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>servername</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Begin an outbound mesh link to another ircd on a network you are already an authenticated member of. 
<p>

<p>
Definition at line <a class="el" href="servers_8cpp-source.html#l00182">182</a> of file <a class="el" href="servers_8cpp-source.html">servers.cpp</a>.
<p>
References <a class="el" href="servers_8h-source.html#l00081">connectors</a>, <a class="el" href="connection_8h-source.html#l00266">connection::fd</a>, <a class="el" href="classircd__connector.html#a1">ircd_connector::MakeOutboundConnection()</a>, <a class="el" href="servers_8cpp-source.html#l00336">SendPacket()</a>, <a class="el" href="classircd__connector.html#a13">ircd_connector::SetHostAndPort()</a>, <a class="el" href="classircd__connector.html#a3">ircd_connector::SetServerName()</a>, <a class="el" href="classircd__connector.html#a7">ircd_connector::SetState()</a>, <a class="el" href="connection_8h-source.html#l00035">STATE_DISCONNECTED</a>, and <a class="el" href="connection_8h-source.html#l00039">STATE_NOAUTH_OUTBOUND</a>.
<p>
<div class="fragment"><pre>00183 {
00184         <span class="keywordtype">char</span> connect[MAXBUF];
00185 
00186         <a class="code" href="classircd__connector.html">ircd_connector</a> connector;
00187 
00188         WriteOpers(<span class="stringliteral">"Establishing meshed link to %s:%d"</span>,servername,newport);
00189 
00190         <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classconnection.html#o0">fd</a>)
00191         {
00192                 <span class="keywordflow">if</span> (connector.<a class="code" href="classircd__connector.html#a1">MakeOutboundConnection</a>(targethost,newport))
00193                 {
00194                         <span class="comment">// targethost has been turned into an ip...</span>
00195                         <span class="comment">// we dont want this as the server name.</span>
00196                         connector.<a class="code" href="classircd__connector.html#a3">SetServerName</a>(servername);
00197                         snprintf(connect,MAXBUF,<span class="stringliteral">"- %lu %s :%s"</span>,cookie,getservername().c_str(),getserverdesc().c_str());
00198                         connector.<a class="code" href="classircd__connector.html#a7">SetState</a>(STATE_NOAUTH_OUTBOUND);
00199                         connector.<a class="code" href="classircd__connector.html#a13">SetHostAndPort</a>(targethost, newport);
00200                         this-&gt;<a class="code" href="classserverrec.html#o11">connectors</a>.push_back(connector);
00201                         <span class="keywordflow">return</span> this-&gt;<a class="code" href="classserverrec.html#a7">SendPacket</a>(connect, servername);
00202                 }
00203                 <span class="keywordflow">else</span>
00204                 {
00205                         connector.<a class="code" href="classircd__connector.html#a7">SetState</a>(STATE_DISCONNECTED);
00206                         WriteOpers(<span class="stringliteral">"Could not create outbound connection to %s:%d"</span>,targethost,newport);
00207                 }
00208         }
00209         <span class="keywordflow">return</span> <span class="keyword">false</span>;
00210 }
</pre></div>    </td>
  </tr>
</table>
<a name="a8" doxytag="serverrec::RecvPacket"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> bool serverrec::RecvPacket </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">std::deque&lt; std::string &gt; &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>messages</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>host</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>std::deque&lt; std::string &gt; &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>sums</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns the next available packet and returns true if data is available. 
<p>
Writes the servername the data came from to 'host'. If no data is available this function returns false. This function will automatically close broken links and reroute pathways, generating split messages on the network. 
<p>
Definition at line <a class="el" href="servers_8cpp-source.html#l00431">431</a> of file <a class="el" href="servers_8cpp-source.html">servers.cpp</a>.
<p>
References <a class="el" href="servers_8cpp-source.html#l00411">already_have_sum()</a>, <a class="el" href="servers_8h-source.html#l00081">connectors</a>, <a class="el" href="modules_8h-source.html#l00023">DEBUG</a>, <a class="el" href="servers_8cpp-source.html#l00042">has_been_netsplit</a>, <a class="el" href="servers_8cpp-source.html#l00256">IsRoutable()</a>, and <a class="el" href="connection_8h-source.html#l00035">STATE_DISCONNECTED</a>.
<p>
<div class="fragment"><pre>00432 {
00433         <span class="keywordtype">char</span> data[65536];
00434         memset(data, 0, 65536);
00435         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; this-&gt;<a class="code" href="classserverrec.html#o11">connectors</a>.size(); i++)
00436         {
00437                 <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classserverrec.html#o11">connectors</a>[i].GetState() != <a class="code" href="connection_8h.html#a0">STATE_DISCONNECTED</a>)
00438                 {
00439                         <span class="comment">// returns false if the packet could not be sent (e.g. target host down)</span>
00440                         <span class="keywordtype">int</span> rcvsize = 0;
00441 
00442                         <span class="comment">// check if theres any data on this socket</span>
00443                         <span class="comment">// if not, continue onwards to the next.</span>
00444                         pollfd polls;
00445                         polls.fd = this-&gt;<a class="code" href="classserverrec.html#o11">connectors</a>[i].GetDescriptor();
00446                         polls.events = POLLIN;
00447                         <span class="keywordtype">int</span> ret = poll(&amp;polls,1,1);
00448                         <span class="keywordflow">if</span> (ret &lt;= 0) <span class="keywordflow">continue</span>;
00449 
00450                         rcvsize = recv(this-&gt;connectors[i].GetDescriptor(),data,65000,0);
00451                         data[rcvsize] = <span class="charliteral">'\0'</span>;
00452                         <span class="keywordflow">if</span> (rcvsize == -1)
00453                         {
00454                                 <span class="keywordflow">if</span> (errno != EAGAIN)
00455                                 {
00456                                         log(DEBUG,<span class="stringliteral">"recv() failed for serverrec::RecvPacket(): %s"</span>,strerror(errno));
00457                                         log(DEBUG,<span class="stringliteral">"Disabling connector: %s"</span>,this-&gt;connectors[i].GetServerName().c_str());
00458                                         this-&gt;<a class="code" href="classserverrec.html#o11">connectors</a>[i].CloseConnection();
00459                                         this-&gt;<a class="code" href="classserverrec.html#o11">connectors</a>[i].SetState(STATE_DISCONNECTED);
00460                                         <span class="keywordflow">if</span> (!<a class="code" href="servers_8cpp.html#a5">IsRoutable</a>(this-&gt;connectors[i].GetServerName()))
00461                                         {
00462                                                 WriteOpers(<span class="stringliteral">"*** Server %s is no longer routable, disconnecting."</span>,this-&gt;connectors[i].GetServerName().c_str());
00463                                                 DoSplit(this-&gt;connectors[i].GetServerName().c_str());
00464                                         }
00465                                         <a class="code" href="servers_8cpp.html#a3">has_been_netsplit</a> = <span class="keyword">true</span>;
00466                                 }
00467                         }
00468                         <span class="keywordtype">int</span> pushed = 0;
00469                         <span class="keywordflow">if</span> (rcvsize &gt; 0)
00470                         {
00471                                 <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classserverrec.html#o11">connectors</a>[i].AddBuffer(data))
00472                                 {
00473                                         WriteOpers(<span class="stringliteral">"*** Read buffer for %s exceeds maximum, closing connection!"</span>,this-&gt;connectors[i].GetServerName().c_str());
00474                                         this-&gt;<a class="code" href="classserverrec.html#o11">connectors</a>[i].CloseConnection();
00475                                         this-&gt;<a class="code" href="classserverrec.html#o11">connectors</a>[i].SetState(STATE_DISCONNECTED);
00476                                         <span class="keywordflow">if</span> (!<a class="code" href="servers_8cpp.html#a5">IsRoutable</a>(this-&gt;connectors[i].GetServerName()))
00477                                         {
00478                                                 WriteOpers(<span class="stringliteral">"*** Server %s is no longer routable, disconnecting."</span>,this-&gt;connectors[i].GetServerName().c_str());
00479                                                 DoSplit(this-&gt;connectors[i].GetServerName().c_str());
00480                                         }
00481                                         <a class="code" href="servers_8cpp.html#a3">has_been_netsplit</a> = <span class="keyword">true</span>;
00482                                 }
00483                                 <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classserverrec.html#o11">connectors</a>[i].BufferIsComplete())
00484                                 {
00485                                         this-&gt;<a class="code" href="classserverrec.html#o11">connectors</a>[i].ResetPing();
00486                                         <span class="keywordflow">while</span> (this-&gt;<a class="code" href="classserverrec.html#o11">connectors</a>[i].BufferIsComplete())
00487                                         {
00488                                                 std::string text = this-&gt;<a class="code" href="classserverrec.html#o11">connectors</a>[i].GetBuffer();
00489                                                 <span class="keywordflow">if</span> (text != <span class="stringliteral">""</span>)
00490                                                 {
00491                                                         <span class="keywordflow">if</span> ((text[0] == <span class="charliteral">':'</span>) &amp;&amp; (text.find(<span class="stringliteral">" "</span>) != std::string::npos))
00492                                                         {
00493                                                                 std::string orig = text;
00494                                                                 log(DEBUG,<span class="stringliteral">"Original: %s"</span>,text.c_str());
00495                                                                 std::string sum = text.substr(1,text.find(<span class="stringliteral">" "</span>)-1);
00496                                                                 text = text.substr(text.find(<span class="stringliteral">" "</span>)+1,text.length());
00497                                                                 std::string possible_token = text.substr(1,text.find(<span class="stringliteral">" "</span>)-1);
00498                                                                 <span class="keywordflow">if</span> (possible_token.length() &gt; 1)
00499                                                                 {
00500                                                                         sums.push_back(<span class="stringliteral">"*"</span>);
00501                                                                         text = orig;
00502                                                                         log(DEBUG,<span class="stringliteral">"Non-mesh, non-tokenized string passed up the chain"</span>);
00503                                                                 }
00504                                                                 <span class="keywordflow">else</span>
00505                                                                 {
00506                                                                         log(DEBUG,<span class="stringliteral">"Packet sum: '%s'"</span>,sum.c_str());
00507                                                                         <span class="keywordflow">if</span> ((<a class="code" href="servers_8cpp.html#a6">already_have_sum</a>(sum)) &amp;&amp; (sum != <span class="stringliteral">"*"</span>))
00508                                                                         {
00509                                                                                 <span class="comment">// we don't accept dupes</span>
00510                                                                                 <span class="keywordflow">continue</span>;
00511                                                                         }
00512                                                                         sums.push_back(sum.c_str());
00513                                                                 }
00514                                                         }
00515                                                         <span class="keywordflow">else</span> sums.push_back(<span class="stringliteral">"*"</span>);
00516                                                         messages.push_back(text.c_str());
00517                                                         strlcpy(recvhost,this-&gt;connectors[i].GetServerName().c_str(),160);
00518                                                         log(DEBUG,<span class="stringliteral">"serverrec::RecvPacket() %d:%s-&gt;%s"</span>,pushed++,recvhost,text.c_str());
00519                                                 }
00520                                         }
00521                                         <span class="keywordflow">return</span> <span class="keyword">true</span>;
00522                                 }
00523                         }
00524                 }
00525         }
00526         <span class="comment">// nothing new yet -- message and host will be undefined</span>
00527         <span class="keywordflow">return</span> <span class="keyword">false</span>;
00528 }
</pre></div>    </td>
  </tr>
</table>
<a name="a7" doxytag="serverrec::SendPacket"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> bool serverrec::SendPacket </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname" nowrap> <em>message</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>host</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Send a message to a server by name, if the server is unavailable directly route the packet via another server If the server still cannot be reached after attempting to route the message remotely, returns false. 
<p>

<p>
Definition at line <a class="el" href="servers_8cpp-source.html#l00336">336</a> of file <a class="el" href="servers_8cpp-source.html">servers.cpp</a>.
<p>
References <a class="el" href="classircd__connector.html#a21">ircd_connector::AddWriteBuf()</a>, <a class="el" href="classircd__connector.html#a14">ircd_connector::CloseConnection()</a>, <a class="el" href="servers_8h-source.html#l00081">connectors</a>, <a class="el" href="modules_8h-source.html#l00023">DEBUG</a>, <a class="el" href="servers_8cpp-source.html#l00242">FindHost()</a>, <a class="el" href="classircd__connector.html#a22">ircd_connector::FlushWriteBuf()</a>, <a class="el" href="classircd__connector.html#a2">ircd_connector::GetServerName()</a>, <a class="el" href="classircd__connector.html#a6">ircd_connector::GetState()</a>, <a class="el" href="classircd__connector.html#a24">ircd_connector::GetWriteError()</a>, <a class="el" href="classircd__connector.html#a7">ircd_connector::SetState()</a>, and <a class="el" href="connection_8h-source.html#l00035">STATE_DISCONNECTED</a>.
<p>
Referenced by <a class="el" href="servers_8cpp-source.html#l00142">BeginLink()</a>, and <a class="el" href="servers_8cpp-source.html#l00182">MeshCookie()</a>.
<p>
<div class="fragment"><pre>00337 {
00338         <span class="keywordflow">if</span> ((!message) || (!sendhost))
00339                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
00340 
00341         <a class="code" href="classircd__connector.html">ircd_connector</a>* cn = this-&gt;<a class="code" href="classserverrec.html#a9">FindHost</a>(sendhost);
00342 
00343         <span class="keywordflow">if</span> (!strchr(message,<span class="charliteral">'\n'</span>))
00344         {
00345                 strlcat(message,<span class="stringliteral">"\n"</span>,MAXBUF);
00346         }
00347 
00348         <span class="keywordflow">if</span> (cn)
00349         {
00350                 log(DEBUG,<span class="stringliteral">"main: serverrec::SendPacket() sent '%s' to %s"</span>,message,cn-&gt;<a class="code" href="classircd__connector.html#a2">GetServerName</a>().c_str());
00351 
00352                 <span class="keywordflow">if</span> (cn-&gt;<a class="code" href="classircd__connector.html#a6">GetState</a>() == <a class="code" href="connection_8h.html#a0">STATE_DISCONNECTED</a>)
00353                 {
00354                         <span class="comment">// fix: can only route one hop to avoid a loop</span>
00355                         <span class="keywordflow">if</span> (strncmp(message,<span class="stringliteral">"R "</span>,2))
00356                         {
00357                                 log(DEBUG,<span class="stringliteral">"Not a double reroute"</span>);
00358                                 <span class="comment">// this route is down, we must re-route the packet through an available point in the mesh.</span>
00359                                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; this-&gt;<a class="code" href="classserverrec.html#o11">connectors</a>.size(); k++)
00360                                 {
00361                                         log(DEBUG,<span class="stringliteral">"Check connector %d: %s"</span>,k,this-&gt;connectors[k].GetServerName().c_str());
00362                                         <span class="comment">// search for another point in the mesh which can 'reach' where we want to go</span>
00363                                         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt; this-&gt;<a class="code" href="classserverrec.html#o11">connectors</a>[k].routes.size(); m++)
00364                                         {
00365                                                 <span class="keywordflow">if</span> (!strcasecmp(this-&gt;connectors[k].routes[m].c_str(),sendhost))
00366                                                 {
00367                                                         log(DEBUG,<span class="stringliteral">"Found alternative route for packet: %s"</span>,this-&gt;connectors[k].GetServerName().c_str());
00368                                                         <span class="keywordtype">char</span> buffer[MAXBUF];
00369                                                         snprintf(buffer,MAXBUF,<span class="stringliteral">"R %s %s"</span>,sendhost,message);
00370                                                         this-&gt;<a class="code" href="classserverrec.html#a7">SendPacket</a>(buffer,this-&gt;connectors[k].GetServerName().c_str());
00371                                                         <span class="keywordflow">return</span> <span class="keyword">true</span>;
00372                                                 }
00373                                         }
00374                                 }
00375                         }
00376                         <span class="keywordtype">char</span> buffer[MAXBUF];
00377                         snprintf(buffer,MAXBUF,<span class="stringliteral">"&amp; %s"</span>,sendhost);
00378                         WriteOpers(<span class="stringliteral">"*** All connections to %s lost."</span>,sendhost);
00379                         NetSendToAllExcept(sendhost,buffer);
00380                         DoSplit(sendhost);
00381                         <span class="keywordflow">return</span> <span class="keyword">false</span>;
00382                 }
00383 
00384                 <span class="comment">// returns false if the packet could not be sent (e.g. target host down)</span>
00385                 <span class="keywordflow">if</span> (!cn-&gt;<a class="code" href="classircd__connector.html#a21">AddWriteBuf</a>(message))
00386                 {
00387                         <span class="comment">// if we're here, there was an error pending, and the send cannot proceed</span>
00388                         log(DEBUG,<span class="stringliteral">"cn-&gt;AddWriteBuf() failed for serverrec::SendPacket(): %s"</span>,cn-&gt;<a class="code" href="classircd__connector.html#a24">GetWriteError</a>().c_str());
00389                         log(DEBUG,<span class="stringliteral">"Disabling connector: %s"</span>,cn-&gt;<a class="code" href="classircd__connector.html#a2">GetServerName</a>().c_str());
00390                         cn-&gt;<a class="code" href="classircd__connector.html#a14">CloseConnection</a>();
00391                         cn-&gt;<a class="code" href="classircd__connector.html#a7">SetState</a>(STATE_DISCONNECTED);
00392                         WriteOpers(<span class="stringliteral">"*** Lost single connection to %s, link inactive and retrying: %s"</span>,cn-&gt;<a class="code" href="classircd__connector.html#a2">GetServerName</a>().c_str(),cn-&gt;<a class="code" href="classircd__connector.html#a24">GetWriteError</a>().c_str());
00393                         <span class="comment">// retry the packet along a new route so either arrival OR failure are gauranteed (bugfix)</span>
00394                         <span class="keywordflow">return</span> this-&gt;<a class="code" href="classserverrec.html#a7">SendPacket</a>(message,sendhost);
00395                 }
00396                 <span class="keywordflow">if</span> (!cn-&gt;<a class="code" href="classircd__connector.html#a22">FlushWriteBuf</a>())
00397                 {
00398                         <span class="comment">// if we're here the write() caused an error, we cannot proceed</span>
00399                         log(DEBUG,<span class="stringliteral">"cn-&gt;FlushWriteBuf() failed for serverrec::SendPacket(): %s"</span>,cn-&gt;<a class="code" href="classircd__connector.html#a24">GetWriteError</a>().c_str());
00400                         log(DEBUG,<span class="stringliteral">"Disabling connector: %s"</span>,cn-&gt;<a class="code" href="classircd__connector.html#a2">GetServerName</a>().c_str());
00401                         cn-&gt;<a class="code" href="classircd__connector.html#a14">CloseConnection</a>();
00402                         cn-&gt;<a class="code" href="classircd__connector.html#a7">SetState</a>(STATE_DISCONNECTED);
00403                         WriteOpers(<span class="stringliteral">"*** Lost single connection to %s, link inactive and retrying: %s"</span>,cn-&gt;<a class="code" href="classircd__connector.html#a2">GetServerName</a>().c_str(),cn-&gt;<a class="code" href="classircd__connector.html#a24">GetWriteError</a>().c_str());
00404                         <span class="comment">// retry the packet along a new route so either arrival OR failure are gauranteed</span>
00405                         <span class="keywordflow">return</span> this-&gt;<a class="code" href="classserverrec.html#a7">SendPacket</a>(message,sendhost);
00406                 }
00407                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
00408         }
00409 }
</pre></div>    </td>
  </tr>
</table>
<a name="a6" doxytag="serverrec::TerminateLink"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void serverrec::TerminateLink </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>targethost</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Terminate a link to 'targethost' by calling the <a class="el" href="classircd__connector.html#a14">ircd_connector::CloseConnection</a> method. 
<p>

<p>
Definition at line <a class="el" href="servers_8cpp-source.html#l00234">234</a> of file <a class="el" href="servers_8cpp-source.html">servers.cpp</a>.
<p>
<div class="fragment"><pre>00235 {
00236         <span class="comment">// this locates the targethost in the serverrec::connectors vector of the class,</span>
00237        <span class="comment">// and terminates it by sending it an SQUIT token and closing its descriptor.</span>
00238         <span class="comment">// TerminateLink with a null string causes a terminate of ALL links</span>
00239 }
</pre></div>    </td>
  </tr>
</table>
<hr><h2>Member Data Documentation</h2>
<a name="o11" doxytag="serverrec::connectors"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> std::vector&lt;<a class="el" href="classircd__connector.html">ircd_connector</a>&gt; <a class="el" href="classserverrec.html#o11">serverrec::connectors</a>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
With a serverrec, this is a list of all established server connections. 
<p>

<p>
Definition at line <a class="el" href="servers_8h-source.html#l00081">81</a> of file <a class="el" href="servers_8h-source.html">servers.h</a>.
<p>
Referenced by <a class="el" href="servers_8cpp-source.html#l00212">AddIncoming()</a>, <a class="el" href="servers_8cpp-source.html#l00142">BeginLink()</a>, <a class="el" href="servers_8cpp-source.html#l00242">FindHost()</a>, <a class="el" href="servers_8cpp-source.html#l00284">FlushWriteBuffers()</a>, <a class="el" href="servers_8cpp-source.html#l00256">IsRoutable()</a>, <a class="el" href="servers_8cpp-source.html#l00182">MeshCookie()</a>, <a class="el" href="servers_8cpp-source.html#l00431">RecvPacket()</a>, <a class="el" href="servers_8cpp-source.html#l00336">SendPacket()</a>, and <a class="el" href="servers_8cpp-source.html#l00046">serverrec()</a>.    </td>
  </tr>
</table>
<a name="o8" doxytag="serverrec::description"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> char <a class="el" href="classserverrec.html#o8">serverrec::description</a>[MAXBUF]
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Description of the server. 
<p>

<p>
Definition at line <a class="el" href="servers_8h-source.html#l00061">61</a> of file <a class="el" href="servers_8h-source.html">servers.h</a>.    </td>
  </tr>
</table>
<a name="o5" doxytag="serverrec::hops_away"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int <a class="el" href="classserverrec.html#o5">serverrec::hops_away</a>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
number of hops away (for quick access) 
<p>

<p>
Definition at line <a class="el" href="servers_8h-source.html#l00051">51</a> of file <a class="el" href="servers_8h-source.html">servers.h</a>.
<p>
Referenced by <a class="el" href="servers_8cpp-source.html#l00046">serverrec()</a>.    </td>
  </tr>
</table>
<a name="o7" doxytag="serverrec::jupiter"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> bool <a class="el" href="classserverrec.html#o7">serverrec::jupiter</a>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
is a JUPE server (faked to enforce a server ban) 
<p>

<p>
Definition at line <a class="el" href="servers_8h-source.html#l00057">57</a> of file <a class="el" href="servers_8h-source.html">servers.h</a>.
<p>
Referenced by <a class="el" href="servers_8cpp-source.html#l00046">serverrec()</a>.    </td>
  </tr>
</table>
<a name="o0" doxytag="serverrec::name"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> char <a class="el" href="classserverrec.html#o0">serverrec::name</a>[MAXBUF]
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
server name 
<p>

<p>
Definition at line <a class="el" href="servers_8h-source.html#l00036">36</a> of file <a class="el" href="servers_8h-source.html">servers.h</a>.
<p>
Referenced by <a class="el" href="servers_8cpp-source.html#l00046">serverrec()</a>.    </td>
  </tr>
</table>
<a name="o9" doxytag="serverrec::nickserv"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> char <a class="el" href="classserverrec.html#o9">serverrec::nickserv</a>[NICKMAX]
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Holds nickserv's name on U:lined (services) servers (this is a kludge for ircservices which ASSUMES things :/). 
<p>

<p>
Definition at line <a class="el" href="servers_8h-source.html#l00065">65</a> of file <a class="el" href="servers_8h-source.html">servers.h</a>.
<p>
Referenced by <a class="el" href="servers_8cpp-source.html#l00046">serverrec()</a>.    </td>
  </tr>
</table>
<a name="o4" doxytag="serverrec::opercount"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> long <a class="el" href="classserverrec.html#o4">serverrec::opercount</a>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
opers on server 
<p>

<p>
Definition at line <a class="el" href="servers_8h-source.html#l00048">48</a> of file <a class="el" href="servers_8h-source.html">servers.h</a>.
<p>
Referenced by <a class="el" href="servers_8cpp-source.html#l00046">serverrec()</a>.    </td>
  </tr>
</table>
<a name="o1" doxytag="serverrec::pingtime"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> long <a class="el" href="classserverrec.html#o1">serverrec::pingtime</a>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
last ping response (ms) 
<p>

<p>
Definition at line <a class="el" href="servers_8h-source.html#l00039">39</a> of file <a class="el" href="servers_8h-source.html">servers.h</a>.
<p>
Referenced by <a class="el" href="servers_8cpp-source.html#l00046">serverrec()</a>.    </td>
  </tr>
</table>
<a name="o10" doxytag="serverrec::sync_soon"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> bool <a class="el" href="classserverrec.html#o10">serverrec::sync_soon</a>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="servers_8h-source.html#l00067">67</a> of file <a class="el" href="servers_8h-source.html">servers.h</a>.
<p>
Referenced by <a class="el" href="servers_8cpp-source.html#l00046">serverrec()</a>.    </td>
  </tr>
</table>
<a name="o3" doxytag="serverrec::usercount"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> long <a class="el" href="classserverrec.html#o3">serverrec::usercount</a>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
non-invisible users on server 
<p>

<p>
Definition at line <a class="el" href="servers_8h-source.html#l00045">45</a> of file <a class="el" href="servers_8h-source.html">servers.h</a>.
<p>
Referenced by <a class="el" href="servers_8cpp-source.html#l00046">serverrec()</a>.    </td>
  </tr>
</table>
<a name="o2" doxytag="serverrec::usercount_i"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> long <a class="el" href="classserverrec.html#o2">serverrec::usercount_i</a>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
invisible users on server 
<p>

<p>
Definition at line <a class="el" href="servers_8h-source.html#l00042">42</a> of file <a class="el" href="servers_8h-source.html">servers.h</a>.
<p>
Referenced by <a class="el" href="servers_8cpp-source.html#l00046">serverrec()</a>.    </td>
  </tr>
</table>
<a name="o6" doxytag="serverrec::version"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> long <a class="el" href="classserverrec.html#o6">serverrec::version</a>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
ircd version 
<p>

<p>
Definition at line <a class="el" href="servers_8h-source.html#l00054">54</a> of file <a class="el" href="servers_8h-source.html">servers.h</a>.
<p>
Referenced by <a class="el" href="servers_8cpp-source.html#l00046">serverrec()</a>.    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="servers_8h-source.html">servers.h</a><li><a class="el" href="servers_8cpp-source.html">servers.cpp</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Wed May 25 21:43:33 2005 for InspIRCd by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.3 </small></address>
</body>
</html>
